{"visual":{"name":"scheduleView","displayName":"ScheduleView","guid":"PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051","visualClassName":"Visual","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"apiVersion":"1.3.0","author":{"name":"","email":""},"assets":{"icon":"assets/icon.png"},"externalJS":[],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Name","kind":"Grouping","name":"Name"},{"displayName":"Type","kind":"Grouping","name":"Type"},{"displayName":"Start","kind":"Grouping","name":"Start"},{"displayName":"End","kind":"Grouping","name":"End"}],"dataViewMappings":[{"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"Name"}},{"for":{"in":"Type"}},{"for":{"in":"Start"}},{"for":{"in":"End"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"png","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"# Copyright (c) ICT GROUP.  All rights reserved.\r\n\r\n##PBI_R_VISUAL: VIZGAL_SCVIEW  Graphical display of schedule, planning or other events.\r\n# Visualise schedule, planning or events in one graph\r\n#\r\n# INPUT:\r\n# Name, Type, Start, End\r\n#\r\n# CREATION DATE: 12/08/2016\r\n#\r\n# LAST UPDATE: 12/08/2016\r\n#\r\n# VERSION: 0.0.1\r\n#\r\n# R VERSION TESTED: 3.3.2\r\n#\r\n# AUTHOR: F.A. THOMSON (frank.thomson@ict.nl)\r\n\r\n\r\n############### LIBRARY DECLARATIONS ###############\r\n\r\nlibraryRequireInstall = function(packageName, ...)\r\n{\r\n  if (!require(packageName, character.only = TRUE))\r\n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep =\r\n                    \"\"))\r\n}\r\n\r\nlibraryRequireInstall(\"ggplot2\")\r\nlibraryRequireInstall(\"grid\")\r\nlibraryRequireInstall(\"gridExtra\")\r\nlibraryRequireInstall(\"wesanderson\")\r\n\r\n############ INTERNAL FUNCTIONS #########\r\n\r\n# plot error message to user\r\nshowErrorMessageToUser <- function(message) {\r\n  par(mar = c(0, 0, 0, 0))\r\n  plot(\r\n    c(0, 1),\r\n    c(0, 1),\r\n    ann = F,\r\n    bty = 'n',\r\n    type = 'n',\r\n    xaxt = 'n',\r\n    yaxt = 'n'\r\n  )\r\n  text(\r\n    x = 0.5,\r\n    y = 0.5,\r\n    message,\r\n    cex = 1.6,\r\n    col = \"black\"\r\n  )\r\n}\r\n\r\n# check if date in handable format\r\n# TDOD for next version: support multiple date formats\r\ndateInCorrectFormat <- function(date) {\r\n  d <- try(as.Date(date, format = \"%Y-%m-%dT%H:%M:%OS\"))\r\n  return (class(d) != \"try-error\" & !is.na(d))\r\n}\r\n\r\n\r\n\r\n############ INPUT / DATE VALIDATION #########\r\n\r\ninput_valid <- TRUE\r\ndates_valid <- TRUE\r\nmessage <- \"\"\r\n\r\nif (!exists(\"Name\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"Name \")\r\n}\r\nif (!exists(\"Type\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"Type \")\r\n}\r\nif (!exists(\"Start\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"Start \")\r\n}\r\nif (!exists(\"End\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"End \")\r\n}\r\n\r\nif (input_valid) {\r\n  # Assign columns to dataset\r\n  dataset <- cbind(Name, Type, Start, End)\r\n  # Rename columns\r\n  colnames(dataset) <- c(\"Name\", \"Type\", \"Start\", \"End\")\r\n  # Remvoe NA's\r\n  dataset <- na.omit(dataset)\r\n  dates_valid <-   (dateInCorrectFormat(dataset$Start[1]) &\r\n                      dateInCorrectFormat(dataset$End[1]))\r\n} else {\r\n  dates_valid <- FALSE\r\n  showErrorMessageToUser(paste(\"All four required, please add: \", message))\r\n}\r\n\r\npalleteType = \"rainbow\"\r\nif(exists(\"settings_legend_params_palleteType\"))\r\n  palleteType = settings_legend_params_palleteType \r\n\r\n############ INPUT / DATE VALIDATION #########\r\n\r\nif (dates_valid) {\r\n  \r\n  if (!exists(\"settings_colorPalette\"))\r\n  {\r\n    settings_colorPalette = \"Set1\";\r\n  }\r\n  \r\n  \r\n  dataset$Start <-\r\n    as.POSIXct(dataset$Start, format = \"%Y-%m-%dT%H:%M:%OS\")\r\n  dataset$End <-\r\n    as.POSIXct(dataset$End,  format = \"%Y-%m-%dT%H:%M:%OS\")\r\n  ggplot(dataset, aes(x = Start, y = Name, color = Type)) +\r\n    geom_segment(aes(\r\n      x = Start,\r\n      xend = End,\r\n      y = Name,\r\n      yend = Name\r\n    ), size = 15) +\r\n    scale_colour_discrete(guide = guide_legend(override.aes = list(size =\r\n                                                                     10))) +\r\n    theme_bw()+ scale_colour_brewer(palette = settings_colorPalette)\r\n  \r\n  \r\n  \r\n} else {\r\n  showErrorMessageToUser(\r\n    paste(\r\n      \"Start and/or End date incorrectly formatted, required format: %Y-%m-%dT%H:%M:%OS\\n\r\n      More dateformats will be supported in newer version\"\r\n    )\r\n    )\r\n}\r\n"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}},"settings":{"displayName":"Settings","description":"Schedule view settings","properties":{"colorPalette":{"displayName":"Color palette","description":"Select brewe color palette","type":{"enumeration":[{"displayName":"Accent","value":"Accent"},{"displayName":"Dark2","value":"Dark2"},{"displayName":"Paired","value":"Paired"},{"displayName":"Pastel1","value":"Pastel1"},{"displayName":"Pastel2","value":"Pastel2"},{"displayName":"Set1","value":"Set1"},{"displayName":"Set2","value":"Set2"},{"displayName":"Set3","value":"Set3"}]}}}}},"suppressDefaultTitle":true},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"gridExtra","displayName":"Grid Extra","url":"https://cran.r-project.org/web/packages/gridExtra/index.html"}]},"content":{"js":"var powerbi;!function(e){var i;!function(e){var i;!function(e){var i;!function(e){function i(e,i,t,a){if(e){var n=e[i];if(n){var s=n[t];if(void 0!==s)return s}}return a}function t(e,i,t,a){if(e){var n=e[i];if(n){var s=n[t];if(void 0!==s&&void 0!==s.solid&&void 0!==s.solid.color)return s.solid.color}}return a}e.getValue=i,e.getFillValue=t}(i=e.PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051||(e.PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051={}))}(i=e.visual||(e.visual={}))}(i=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var i;!function(e){var i;!function(e){var i;!function(e){var i=function(){function i(e){this.imageDiv=document.createElement(\"div\"),this.imageDiv.className=\"rcv_autoScaleImageContainer\",e.element.appendChild(this.imageDiv),this.imageElement=document.createElement(\"img\"),this.imageElement.className=\"rcv_autoScaleImage\",this.imageDiv.appendChild(this.imageElement)}return i.prototype.update=function(e){var i=e.dataViews;if(i&&0!==i.length){var t=i[0];if(t&&t.metadata){this.updateObjects(t.metadata.objects);var a=null;t.scriptResult&&t.scriptResult.payloadBase64&&(a=\"data:image/png;base64,\"+t.scriptResult.payloadBase64),a?this.imageElement.src=a:this.imageElement.src=null,this.onResizing(e.viewport)}}},i.prototype.onResizing=function(e){this.imageDiv.style.height=e.height+\"px\",this.imageDiv.style.width=e.width+\"px\"},i.prototype.updateObjects=function(i){this.settings={colorPalette:e.getValue(i,\"settings\",\"colorPallette\",\"Set1\")}},i.prototype.enumerateObjectInstances=function(e){var i=e.objectName,t=[];switch(i){case\"settings\":t.push({objectName:i,properties:{colorPalette:this.settings.colorPalette},selector:null})}return t},i}();e.Visual=i}(i=e.PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051||(e.PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051={}))}(i=e.visual||(e.visual={}))}(i=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var i;!function(i){var t;!function(i){i.PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051={name:\"PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051\",displayName:\"ScheduleView\",class:\"Visual\",version:\"1.0.0\",apiVersion:\"1.3.0\",create:function(i){return new e.extensibility.visual.PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051.Visual(i)},custom:!0}}(t=i.plugins||(i.plugins={}))}(i=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));","css":".visual-PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051 .rcv_autoScaleImageContainer{position:relative}.visual-PBI_CV_658497A5_7E34_4F94_A51F_4E2213BB9051 .rcv_autoScaleImageContainer .rcv_autoScaleImage{max-width:100%;max-height:100%;position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);-webkit-transform:translateY(-50%) translateX(-50%)}","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="}}