{"visual":{"name":"scheduleViewRHTML","displayName":"ScheduleViewRHTML","guid":"scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464","visualClassName":"Visual","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"apiVersion":"1.7.0","author":{"name":"","email":""},"assets":{"icon":"assets/icon.png"},"externalJS":["node_modules/powerbi-visuals-utils-dataviewutils/lib/index.js"],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Resource","kind":"Grouping","name":"Resource"},{"displayName":"User","kind":"Grouping","name":"User"},{"displayName":"Start","kind":"Grouping","name":"Start"},{"displayName":"End","kind":"Grouping","name":"End"}],"dataViewMappings":[{"conditions":[{"Resource":{"max":1},"User":{"max":1},"Start":{"max":1},"End":{"max":1}}],"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"Resource"}},{"for":{"in":"User"}},{"for":{"in":"Start"}},{"for":{"in":"End"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"html","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"# Copyright (c) ICT GROUP.  All rights reserved.\r\n\r\n##PBI_R_VISUAL: VIZGAL_SCVIEW  Graphical display of schedule, planning or other events.\r\n# Visualise schedule, planning or events in one graph\r\n#\r\n# INPUT:\r\n# Resource, User, Start, End\r\n#\r\n# CREATION DATE: 12/08/2016\r\n#\r\n# LAST UPDATE: 01/17/2017\r\n#\r\n# VERSION: 1.0.0\r\n#\r\n# R VERSION TESTED: 3.3.2\r\n#\r\n# AUTHOR: F.A. THOMSON (frank.thomson@ict.nl)\r\n\r\n\r\n############### LIBRARY DECLARATIONS ###############\r\n\r\nlibraryRequireInstall = function(packageName, ...)\r\n{\r\n  if (!require(packageName, character.only = TRUE))\r\n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep =\r\n                    \"\"))\r\n}\r\n\r\nlibraryRequireInstall(\"ggplot2\")\r\nlibraryRequireInstall(\"grid\")\r\nlibraryRequireInstall(\"gridExtra\")\r\nlibraryRequireInstall(\"wesanderson\")\r\nlibraryRequireInstall(\"RColorBrewer\")\r\nlibraryRequireInstall(\"dplyr\")\r\n\r\n#RVIZ_IN_PBI_GUIDE:BEGIN: Added to create HTML-based \r\n############### Utility functions ###############\nlibraryRequireInstall = function(packageName, ...)\n{\n  if(!require(packageName, character.only = TRUE)) \n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\n}\n\nlibraryRequireInstall(\"XML\")\nlibraryRequireInstall(\"htmlwidgets\")\n\ninternalSaveWidget <- function(widget, fname)\n{\n  tempFname = paste(fname, \".tmp\", sep=\"\")\n  htmlwidgets::saveWidget(widget, file = tempFname, selfcontained = FALSE)\n  FlattenHTML(tempFname, fname)\n}\n\nFlattenHTML <- function(fnameIn, fnameOut)\n{\n  # Read and parse HTML file\n  # Embed all js and css files into one unified file\n  \n  if(!file.exists(fnameIn))\n    return(FALSE)\n  \n  dir = dirname(fnameIn)\n  html = htmlTreeParse(fnameIn, useInternal = TRUE)\n  top = xmlRoot(html)\n  \n  # extract all <script> tags with src value\n  srcNode=getNodeSet(top, '//script[@src]')\n  for (node in srcNode)\n  {\n    b = xmlAttrs(node)\n    fname = file.path(dir, b['src'])\n    alternateSrc = FindSrcReplacement(fname)\n    if (!is.null(alternateSrc))\n    {\n      s = alternateSrc\n      names(s) = 'src'\n      newNode = xmlNode(\"script\",attrs = s)\n      replaceNodes(node, newNode)\n    }else{\n      str=ReadFileForEmbedding(fname);\n      if (!is.null(str))\n      {      \n        newNode = xmlNode(\"script\", str, attrs = c(type = \"text/javascript\"))\n        replaceNodes(node, newNode)\n      }\n    }\n  }\n  \n  # extract all <link> tags with src value\n  linkNode=getNodeSet(top, '//link[@href]')\n  for (node in linkNode)\n  {\n    b = xmlAttrs(node)\n    fname = file.path(dir, b['href'])\n    str = ReadFileForEmbedding(fname, FALSE);\n    if (!is.null(str))\n    {\n      newNode = xmlNode(\"style\", str)\n      replaceNodes(node, newNode)\n    }\n  }\n  \n  saveXML(html, file = fnameOut)\n  return(TRUE)\n}\n\nReadFileForEmbedding <- function(fname, addCdata = TRUE)\n{\n  data = ReadFullFile(fname)\n  if (is.null(data))\n    return(NULL)\n\n  str = paste(data, collapse ='\\n')\n  if (addCdata) {\n    str = paste(cbind('// <![CDATA[', str,'// ]]>'), collapse ='\\n')\n  }\n  return(str)\n}\n\nReadFullFile <- function(fname)\n{\n  if(!file.exists(fname))\n    return(NULL)\n  \n  con = file(fname, open = \"r\")\n  data = readLines(con)\n  close(con)\n  return(data)\n}\n\nFindSrcReplacement <- function(str)\n{\n  # finds reference to 'plotly' js and replaces with a version from CDN\n  # This allows the HTML to be smaller, since this script is not fully embedded in it\n  str <- iconv(str, to=\"UTF-8\")\n  pattern = \"plotlyjs-(\\\\w.+)/plotly-latest.min.js\"\n  match1=regexpr(pattern, str)\n  attr(match1, 'useBytes') <- FALSE\n  strMatch=regmatches(str, match1, invert = FALSE)\n  if (length(strMatch) == 0) return(NULL)\n  \n  pattern2 = \"-(\\\\d.+)/\"\n  match2 = regexpr(pattern2, strMatch[1])\n  attr(match2, 'useBytes') <- FALSE\n  strmatch = regmatches(strMatch[1], match2)\n  if (length(strmatch) == 0) return(NULL)\n  \n  # CDN url is https://cdn.plot.ly/plotly-<Version>.js\n  # This matches the specific version used in the plotly package used.\n  verstr = substr(strmatch, 2, nchar(strmatch)-1)\n  str = paste('https://cdn.plot.ly/plotly-', verstr,'.min.js', sep='')\n  return(str)\n}\n#################################################\n\r\nlibraryRequireInstall(\"plotly\")\r\n#RVIZ_IN_PBI_GUIDE:END: Added to create HTML-based  s\r\n\r\n############ INTERNAL FUNCTIONS #########\r\n\r\n# plot error message to user\r\nshowErrorMessageToUser <- function(message) {\r\n  par(mar = c(0, 0, 0, 0))\r\n  plot(\r\n    c(0, 1),\r\n    c(0, 1),\r\n    ann = F,\r\n    bty = 'n',\r\n    type = 'n',\r\n    xaxt = 'n',\r\n    yaxt = 'n'\r\n  )\r\n  text(\r\n    x = 0.5,\r\n    y = 0.5,\r\n    message,\r\n    cex = 1.6,\r\n    col = \"black\"\r\n  )\r\n}\r\n\r\n# check if date in handable format\r\n# TDOD for next version: support multiple date formats\r\ndateInCorrectFormat <- function(date) {\r\n  d <- try(as.Date(date, format = \"%Y-%m-%dT%H:%M:%OS\"))\r\n  if(class(d) == \"try-error\" | is.na(d)){\r\n    d <- try(as.POSIXct(date))\r\n  }\r\n  \r\n  return (class(d) != \"try-error\" & !is.na(d))\r\n}\r\n\r\n\r\n# Get segment size so that they do not overlap on resize / large number of resources.\r\n\r\ngetSegmentSize = function(numCols, numRows, orientation = \"horizontal\", maxW = 25, minW = 1)\r\n{\r\n  convFactor = 20 # unit conversion\r\n  hw = par()$din\r\n  if(orientation == \"horizontal\")\r\n    segSize = hw[2]/numCols\r\n  else\r\n    segSize = 0.5* hw[1]/numRows # take legend into account \r\n  \r\n  segSize = min(max(segSize*convFactor, minW),maxW)\r\n  \r\n  return(segSize)\r\n}\r\n\r\n# Sort the dataset. A-Z (az), Z-A (za), total duration (total_duration) and user count (user_count)\r\n\r\nsortDataset = function(dataset, sorting = \"az\", orientation=\"horizontal\")\r\n{\r\n  switch(sorting,\r\n         \"az\" = {\r\n           if(settings_orientation == \"horizontal\"){\r\n              dataset$Resource  <- factor(dataset$Resource, levels= dataset[rev(order(dataset$Resource)), \"Resource\"])\r\n           } else {\r\n             dataset$Resource  <- factor(dataset$Resource, levels= dataset[order(dataset$Resource), \"Resource\"])\r\n           }\r\n         },\r\n         \"za\" = {\r\n           if(settings_orientation == \"horizontal\"){\r\n             dataset$Resource  <- factor(dataset$Resource, levels= dataset[order(dataset$Resource), \"Resource\"])\r\n           } else {\r\n             dataset$Resource  <- factor(dataset$Resource, levels= dataset[rev(order(dataset$Resource)), \"Resource\"])\r\n           }\r\n        \r\n         },\r\n         \"total_duration\" = {\r\n           dataset$duration <- difftime(dataset$End, dataset$Start, units=\"secs\")\r\n           dataset$duration[is.na(dataset$duration)] <- 0 \r\n           temp <- dataset %>% group_by(Resource) %>% summarize(t=sum(duration)) %>% arrange(t)\r\n           if(settings_orientation == \"horizontal\"){\r\n             dataset$Resource  <- factor(dataset$Resource, levels= temp$Resource)\r\n           } else {\r\n             dataset$Resource  <- factor(dataset$Resource, levels= rev(temp$Resource))\r\n           }\r\n         },\r\n         \"user_count\" = {\r\n           temp <- dataset %>% group_by(Resource) %>% summarize(n=n()) %>% arrange(n)\r\n           if(settings_orientation == \"horizontal\"){\r\n             dataset$Resource  <- factor(dataset$Resource, levels= temp$Resource)\r\n           } else {\r\n             dataset$Resource  <- factor(dataset$Resource, levels= rev(temp$Resource))\r\n           }\r\n         })\r\n  return(dataset)\r\n}\r\n\r\n# strText = text to modify \r\n# strCex = font size \r\n# abbrTo = very long string will be abbreviated to \"abbrTo\" characters\r\n# isH = \"is horizontal\" ?\r\n# maxChar = text smaller than maxChar is replaced by NULL\r\n# partAvailable = which portion of window is available for text, in [0,1]\r\n\r\ncutStr2Show = function(strText, strCex = 0.8, abbrTo = 100, isH = TRUE, maxChar = 0, partAvailable = 1)\r\n{\r\n\r\n  if(is.null(strText))\r\n    return (NULL)\r\n  \r\n  SCL = 0.094*strCex\r\n  pardin = par()$din\r\n  gStand = partAvailable*(isH*pardin[1]+(1-isH)*pardin[2]) /SCL\r\n  \r\n  # if very very long abbreviate\r\n  if(nchar(strText)>abbrTo && nchar(strText)> 1)\r\n    strText = abbreviate(strText, abbrTo, dot = TRUE)\r\n  \r\n  # if looooooong convert to lo...\r\n  if(nchar(strText)>round(gStand) && nchar(strText)> 1)\r\n    strText = paste(substring(strText,1,floor(gStand)),\"...\",sep=\"\")\r\n  \r\n  # if shorter than maxChar remove \r\n  if(gStand<=maxChar)\r\n    strText = NULL\r\n  \r\n  return(strText) \r\n}\r\n\r\n\r\n# Calculate and return the number of legend columns as selected by the user\r\n\r\ngetNcolLegend = function(ncols = \"auto\"){\r\n  colCount <- 1;\r\n  switch(ncols,\r\n        \"auto\" = { colCount <- ceiling(nrow(unique(User))/nrow(unique(Resource)))},\r\n        \"one\" = {colCount <- 1},\r\n        \"two\" = {colCount <- 2},\r\n        \"three\" = {colCount <- 3},\r\n        \"four\" = {colCount <- 4},\r\n        \"five\" = {colCount <- 5})\r\n  return(colCount)\r\n}\r\n  \r\n\r\n\r\n\r\n############ INPUT / DATE VALIDATION #########\r\n\r\ninput_valid <- TRUE\r\ndates_valid <- TRUE\r\nmessage <- \"\"\r\n\r\nif (!exists(\"Resource\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"Resource \")\r\n}\r\nif (!exists(\"User\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"User \")\r\n}\r\nif (!exists(\"Start\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"Start \")\r\n}\r\nif (!exists(\"End\")) {\r\n  input_valid <- FALSE\r\n  message <- paste(message, \"End \" + settings_orientation)\r\n}\r\n\r\n\r\n\r\n\r\n\r\nif (input_valid) {\r\n  # Assign columns to dataset\r\n  dataset <- cbind(Resource, User, Start, End)\r\n  # Rename columns\r\n  colnames(dataset) <- c(\"Resource\", \"User\", \"Start\", \"End\")\r\n  # Remvoe NA's\r\n  dataset <- na.omit(dataset)\r\n  dates_valid <-   (dateInCorrectFormat(dataset$Start[1]) &\r\n                      dateInCorrectFormat(dataset$End[1]))\r\n} else {\r\n  dates_valid <- FALSE\r\n  plot.new()\r\n  #showErrorMessageToUser(paste(\"All four fields required, please add: \", message))\r\n}\r\n\r\n\r\n\r\n############ INPUT / DATE VALIDATION #########\r\nif(input_valid){\r\n\r\nif (dates_valid) {\r\n  if(!exists(\"settings_sorting\"))\r\n  {\r\n    settings_sorting = \"az\";\r\n  }\r\n  \r\n  if (!exists(\"settings_colorPalette\"))\r\n  {\r\n    settings_colorPalette = \"Set1\";\r\n  }\r\n  \r\n  if (!exists(\"settings_orientation\"))\r\n  {\r\n    settings_orientation= \"horizontal\";\r\n  }\r\n  if(!exists(\"settings_legendCols\")){\r\n    settings_legendCols = \"auto\";\r\n  }\r\n  \r\n  dataset$Start <-\r\n    as.POSIXct(dataset$Start, format = \"%Y-%m-%dT%H:%M:%OS\")\r\n  dataset$End <-\r\n    as.POSIXct(dataset$End,  format = \"%Y-%m-%dT%H:%M:%OS\")\r\n  \r\n  colourCount <- length(unique(dataset$User))\r\n  getPalette <- colorRampPalette(brewer.pal(8, settings_colorPalette))\r\n  \r\n  segSize = getSegmentSize(length(unique(dataset$Resource)), length(unique(dataset$User)), orientation = settings_orientation)\r\n  \r\n  dataset <- sortDataset(dataset, sorting = settings_sorting, orientation = settings_orientation)\r\n  \r\n  dataset$User <- abbreviate(dataset$User, 30)\r\n  \r\n  ncolLegend <- getNcolLegend(ncols = settings_legendCols);\r\n\r\n  if(settings_orientation == \"horizontal\"){\r\n      g <- ggplot(dataset, aes(x = Start, y = Resource, color = User)) +\r\n      geom_segment(aes(x = Start, xend = End, y = Resource,yend = Resource), size = segSize) +\r\n      xlab(\"Time\") +\r\n      ylab(cutStr2Show(names(Resource), abbrTo = 50)) +\r\n      labs(color=names(User))+\r\n      theme_bw()  +\r\n      scale_colour_manual(values = getPalette(colourCount)) + \r\n      theme(legend.direction =\"vertical\",legend.position = \"right\") + guides(color=guide_legend(ncol=ncolLegend))\r\n\r\n  } else {\r\n      g <- ggplot(dataset, aes(x = Resource, y = Start, color = User)) +\r\n      geom_segment(aes(x = Resource, xend = Resource, y = Start,yend = End), size = segSize) +\r\n      ylab(\"Time\") +\r\n      xlab(cutStr2Show(names(Resource), abbrTo = 50)) +\r\n      labs(color=names(User))+\r\n      theme_bw() + \r\n      scale_colour_manual(values = getPalette(colourCount)) +\r\n      theme(axis.text.x = element_text(angle = 45, hjust = 1))+ guides(color=guide_legend(ncol=ncolLegend))\r\n  }\r\n\r\n\tp = ggplotly(g);\r\n\r\n\t# some plotly re-design \r\n\tdisabledButtonsList <- list('toImage', 'sendDataToCloud', 'zoom2d', 'pan', 'pan2d', 'select2d', 'lasso2d', 'hoverClosestCartesian', 'hoverCompareCartesian')\r\n\tp$x$config$modeBarButtonsToRemove = disabledButtonsList\r\n\tp <- config(p, staticPlot = FALSE, editable = FALSE, sendData = FALSE, showLink = FALSE,\r\n\t    displaylogo = FALSE,  collaborate = FALSE, cloud=FALSE)\r\n\r\n\tinternalSaveWidget(p, 'out.html');\r\n  \r\n  \r\n} else {\r\n  showErrorMessageToUser(\r\n    paste0(\"Unable to parse dates\\n\r\n      dates recieved: Start[1]= \", Start[1], \"   End[1]=\", End[1]\r\n    )\r\n    )\r\n}\r\n}\r\n  \r\n"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}},"settings":{"displayName":"Settings","description":"Schedule view settings","properties":{"sorting":{"displayName":"Sort","description":"Resource sorting","type":{"enumeration":[{"displayName":"Alphabetical A-Z","value":"az"},{"displayName":"Alphabetical Z-A","value":"za"},{"displayName":"By total duration","value":"total_duration"},{"displayName":"By user count","value":"user_count"}]}},"orientation":{"displayName":"Orientation","description":"Visual orientation","type":{"enumeration":[{"displayName":"Horizontal","value":"horizontal"},{"displayName":"Vertical","value":"vertical"}]}},"colorPalette":{"displayName":"Color palette","description":"Select brewer color palette","type":{"enumeration":[{"displayName":"Spring","value":"Accent"},{"displayName":"Vintage","value":"Dark2"},{"displayName":"Green and blue","value":"Paired"},{"displayName":"Vintage light","value":"Pastel1"},{"displayName":"Modern light","value":"Pastel2"},{"displayName":"Retro light","value":"Set1"},{"displayName":"Retro","value":"Set2"},{"displayName":"Modern","value":"Set3"}]}},"legendCols":{"displayName":"Legend columns","description":"# of legend columns","type":{"enumeration":[{"displayName":"auto","value":"auto"},{"displayName":"1","value":"one"},{"displayName":"2","value":"two"},{"displayName":"3","value":"three"},{"displayName":"4","value":"four"},{"displayName":"5","value":"five"}]}}}}},"suppressDefaultTitle":true},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"grid","displayName":"Grid","url":"https://cran.r-project.org/web/packages/grid/index.html"},{"name":"gridExtra","displayName":"Grid Extra","url":"https://cran.r-project.org/web/packages/gridExtra/index.html"},{"name":"wesanderson","displayName":"A Wes Anderson Palette Generator","url":"https://cran.r-project.org/web/packages/wesanderson/index.html"},{"name":"dplyr","displayName":"A fast, consistent tool for working with data frame like objects, both in memory and out of memory.","url":"https://cran.r-project.org/web/packages/dplyr/index.html"},{"name":"plotly","displayName":"Plotly","url":"https://cran.r-project.org/web/packages/plotly/index.html"},{"name":"htmlwidgets","displayName":"HTML Widgets","url":"https://cran.r-project.org/web/packages/htmlwidgets/index.html"},{"name":"XML","displayName":"XML","url":"https://cran.r-project.org/web/packages/XML/index.html"}]},"stringResources":{},"content":{"js":"var powerbi;!function(e){!function(e){!function(e){!function(e){!function(e){function t(e,t,n){void 0===e&&(e=[]);var r=e;return i(r),t&&(r.identityFields=t),n&&(r.source=n),r}function i(e,t){e.grouped=t?function(){return t}:function(){return n(e)}}function n(e){for(var t,i=[],n=0,r=e.length;n<r;n++){var o=e[n];if(!t||t.identity!==o.identity){if(t={values:[]},o.identity){t.identity=o.identity;var a=o.source;void 0!==a.groupName?t.name=a.groupName:a.displayName&&(t.name=a.displayName)}i.push(t)}t.values.push(o)}return i}e.createValueColumns=t,e.setGrouped=i,e.groupValues=n}(e.DataViewTransform||(e.DataViewTransform={}))}(e.dataview||(e.dataview={}))}(e.utils||(e.utils={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){!function(e){!function(e){!function(e){function t(e,t){if(!e||!e.length)return-1;var i=e[0];if(i.values&&i.values.length>0)for(var r=0,o=i.values.length;r<o;++r){var a=i.values[r];if(a&&a.source&&n(a.source,t))return r}return-1}function i(e,t){if(e&&e.length)for(var i=0,r=e.length;i<r;i++)if(n(e[i].source,t))return i;return-1}function n(e,t){var i=e.roles;return i&&i[t]}function r(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&e.metadata.columns.some(function(e){return e.roles&&void 0!==e.roles[t]})}function o(e,t){return e&&e.source&&e.source.roles&&!0===e.source.roles[t]}e.getMeasureIndexOfRole=t,e.getCategoryIndexOfRole=i,e.hasRole=n,e.hasRoleInDataView=r,e.hasRoleInValueColumn=o}(e.DataRoleHelper||(e.DataRoleHelper={}))}(e.dataview||(e.dataview={}))}(e.utils||(e.utils={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){!function(e){!function(e){!function(e){function t(e,t,i){if(!e)return i;var n=e[t];return void 0===n?i:n}function i(e,i,n){var r=t(e,i);return r&&r.solid?r.solid.color:n}e.getValue=t,e.getFillColorByPropertyName=i}(e.DataViewObject||(e.DataViewObject={}))}(e.dataview||(e.dataview={}))}(e.utils||(e.utils={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){!function(e){!function(e){!function(t){function i(t,i,n){return t?e.DataViewObject.getValue(t[i.objectName],i.propertyName,n):n}function n(e,t,i){return e&&e[t]?e[t]:i}function r(e,t,n){var r=i(e,t);return r&&r.solid?r.solid.color:n}function o(e,t,n){var r=i(e,t,n);return r&&r.solid?r.solid.color:void 0===r||null===r||\"object\"==typeof r&&!r.solid?n:r}t.getValue=i,t.getObject=n,t.getFillColor=r,t.getCommonValue=o}(e.DataViewObjects||(e.DataViewObjects={}))}(e.dataview||(e.dataview={}))}(e.utils||(e.utils={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(t){!function(t){!function(t){var i=e.extensibility.utils.dataview.DataRoleHelper;!function(e){function t(e,t,n){if(e.categories&&e.categories.length>0){var r=e.categories[0];return r.source&&i.hasRole(r.source,t)&&i.hasRole(r.source,n)}return!1}function n(e){return void 0!==e.groupName?e.groupName:e.queryName}function r(e){var t=a(e);return null!=t&&!0===t.imageUrl}function o(e){var t=a(e);return null!=t&&!0===t.webUrl}function a(e){return e&&e.type&&e.type.misc}function u(e){return!!(e&&e.metadata&&e.metadata.columns&&e.metadata.columns.length)&&e.metadata.columns.some(function(e){return!0===r(e)})}e.categoryIsAlsoSeriesRole=t,e.getSeriesName=n,e.isImageUrlColumn=r,e.isWebUrlColumn=o,e.getMiscellaneousTypeDescriptor=a,e.hasImageUrlColumn=u}(t.converterHelper||(t.converterHelper={}))}(t.dataview||(t.dataview={}))}(t.utils||(t.utils={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){!function(e){!function(e){var t=function(){function t(){}return t.getDefault=function(){return new this},t.createPropertyIdentifier=function(e,t){return{objectName:e,propertyName:t}},t.parse=function(t){var i,n=this.getDefault();if(!t||!t.metadata||!t.metadata.objects)return n;i=n.getProperties();for(var r in i)for(var o in i[r]){var a=n[r][o];n[r][o]=e.DataViewObjects.getCommonValue(t.metadata.objects,i[r][o],a)}return n},t.isPropertyEnumerable=function(e){return!t.InnumerablePropertyPrefix.test(e)},t.enumerateObjectInstances=function(e,t){var i=e&&e[t.objectName];if(!i)return[];var n={objectName:t.objectName,selector:null,properties:{}};for(var r in i)i.hasOwnProperty(r)&&(n.properties[r]=i[r]);return{instances:[n]}},t.prototype.getProperties=function(){var e=this,i={};return Object.keys(this).forEach(function(n){if(t.isPropertyEnumerable(n)){var r=Object.keys(e[n]);i[n]={},r.forEach(function(e){t.isPropertyEnumerable(n)&&(i[n][e]=t.createPropertyIdentifier(n,e))})}}),i},t}();t.InnumerablePropertyPrefix=/^_/,e.DataViewObjectsParser=t}(e.dataview||(e.dataview={}))}(e.utils||(e.utils={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},powerbi;!function(e){!function(e){!function(e){!function(e){\"use strict\";function t(){a=0}function i(){return 0===a}function n(e,t){var i=[];if(e&&e.hasChildNodes()){for(var n=e.children,o=0;o<n.length;o++){var a=void 0;a=\"script\"===n.item(o).nodeName.toLowerCase()?r(n.item(o)):n.item(o).cloneNode(!0),t.appendChild(a),i.push(a)}return i}}function r(e){for(var t=document.createElement(\"script\"),i=e.attributes,n=0;n<i.length;n++)t.setAttribute(i[n].name,i[n].textContent),\"src\"===i[n].name.toLowerCase()&&(a++,t.onload=function(){a--});return t.innerHTML=e.innerHTML,t}function o(){var e=window.setInterval(function(){i()&&(window.clearInterval(e),window.hasOwnProperty(\"HTMLWidgets\")&&window.HTMLWidgets.staticRender&&window.HTMLWidgets.staticRender())},100)}var a=0;e.ResetInjector=t,e.injectorReady=i,e.ParseElement=n,e.RunHTMLWidgetRenderer=o}(e.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464||(e.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464={}))}(e.visual||(e.visual={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(t){!function(t){!function(t){\"use strict\";var i=e.extensibility.utils.dataview.DataViewObjectsParser,n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rcv_script=new r,t}return __extends(t,e),t}(i);t.VisualSettings=n;var r=function(){function e(){}return e}();t.rcv_scriptSettings=r}(t.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464||(t.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464={}))}(t.visual||(t.visual={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(t){!function(t){!function(t){\"use strict\";var i=[e.VisualUpdateType.Resize,e.VisualUpdateType.ResizeEnd,e.VisualUpdateType.Resize+e.VisualUpdateType.ResizeEnd],n=function(){function e(e){e&&e.element&&(this.rootElement=e.element),this.headNodes=[],this.bodyNodes=[]}return e.prototype.update=function(t){if(t&&t.type&&t.viewport&&t.dataViews&&0!==t.dataViews.length&&t.dataViews[0]){var n=t.dataViews[0];this.settings=e.parseSettings(n);var r=null;n.scriptResult&&n.scriptResult.payloadBase64&&(r=n.scriptResult.payloadBase64),-1===i.indexOf(t.type)?r&&this.injectCodeFromPayload(r):this.onResizing(t.viewport)}},e.prototype.onResizing=function(e){},e.prototype.injectCodeFromPayload=function(e){if(t.ResetInjector(),e){var i=document.createElement(\"html\");try{i.innerHTML=window.atob(e)}catch(e){return}if(0===this.headNodes.length){for(;this.headNodes.length>0;){var n=this.headNodes.pop();document.head.removeChild(n)}var r=i.getElementsByTagName(\"head\");if(r&&r.length>0){var o=r[0];this.headNodes=t.ParseElement(o,document.head)}}for(;this.bodyNodes.length>0;){var n=this.bodyNodes.pop();this.rootElement.removeChild(n)}var a=i.getElementsByTagName(\"body\");if(a&&a.length>0){var u=a[0];this.bodyNodes=t.ParseElement(u,this.rootElement)}t.RunHTMLWidgetRenderer()}},e.parseSettings=function(e){return t.VisualSettings.parse(e)},e.prototype.enumerateObjectInstances=function(e){return t.VisualSettings.enumerateObjectInstances(this.settings||t.VisualSettings.getDefault(),e)},e}();t.Visual=n}(t.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464||(t.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464={}))}(t.visual||(t.visual={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(t){!function(t){t.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464={name:\"scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464\",displayName:\"ScheduleViewRHTML\",class:\"Visual\",version:\"1.0.0\",apiVersion:\"1.7.0\",create:function(t){return new e.extensibility.visual.scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464.Visual(t)},custom:!0}}(t.plugins||(t.plugins={}))}(e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));","css":".visual-scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464 .rcv_autoScaleImageContainer{position:relative}.visual-scheduleViewRHTML20015F17080644B8B68EC99ADAA3E464 .rcv_autoScaleImageContainer .rcv_autoScaleImage{max-width:100%;max-height:100%;position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);-webkit-transform:translateY(-50%) translateX(-50%)}","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="}}